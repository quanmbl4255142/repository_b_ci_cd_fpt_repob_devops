# flask-test-02 - Kubernetes Manifests

Generated by Django Dev Portal

## 📦 Deployment Information

- **Application**: flask-test-02
- **Namespace**: flask-test-02
- **Docker Image**: ghcr.io/blueduck0907/aemo-v6
- **Port**: 8000

## 📁 Files

- `namespace.yaml` - Kubernetes namespace
- `deployment.yaml` - Application deployment with 2 replicas
- `service.yaml` - ClusterIP service
- `pvc.yaml` - PersistentVolumeClaim (1Gi)
- `ingress.yaml` - Ingress configuration
- `kustomization.yaml` - Kustomize configuration
- `argocd-application.yaml` - ArgoCD Application definition

## 🚀 Deployment to Repository_B (Multi-App Structure)

### Step 1: Add to Repository_B

```bash
# Clone Repository_B
git clone https://github.com/quanmbl4255142/repository_b_ci_cd_fpt_repob_devops.git
cd Repository_B

# Copy manifests to apps/<app-name>/ directory
mkdir -p apps/flask-test-02
cp <this-directory>/*.yaml apps/flask-test-02/

# Commit and push
git add apps/flask-test-02/
git commit -m "Add flask-test-02 manifests"
git push origin main
```

### Step 2: ArgoCD Auto-Deploys

ArgoCD ApplicationSet tự động:
- Phát hiện app mới trong `apps/flask-test-02/`
- Tạo Application `flask-test-02`
- Deploy vào namespace `flask-test-02`

```bash
# Check Applications
kubectl get applications -n argocd

# Watch sync
kubectl get app flask-test-02 -n argocd -w
```

### Step 3: Verify Deployment

```bash
# Check pods
kubectl get pods -n flask-test-02

# Check service
kubectl get svc -n flask-test-02

# Check ingress
kubectl get ingress -n flask-test-02

# View logs
kubectl logs -f deployment/flask-test-02 -n flask-test-02
```

## 🔄 Auto-Deployment Workflow

1. Push code to your app repository
2. GitHub Actions builds Docker image
3. Image pushed to registry: ghcr.io/blueduck0907/aemo-v6
4. ArgoCD Image Updater detects new image
5. Updates deployment.yaml in Repository_B
6. ArgoCD syncs changes
7. New pods deployed automatically

## 🛠️ Manual Operations

### Force sync
```bash
kubectl patch app flask-test-02 -n argocd \
  -p '{"metadata":{"annotations":{"argocd.argoproj.io/refresh":"hard"}}}' \
  --type merge
```

### Restart deployment
```bash
kubectl rollout restart deployment/flask-test-02 -n flask-test-02
```

### Scale replicas
```bash
kubectl scale deployment/flask-test-02 -n flask-test-02 --replicas=3
```

### Delete application
```bash
kubectl delete app flask-test-02 -n argocd
kubectl delete namespace flask-test-02
```

## 📊 Monitoring

### Health Check
```bash
curl http://<ingress-host>/api/health/
```

### Resource Usage
```bash
kubectl top pods -n flask-test-02
```

### Events
```bash
kubectl get events -n flask-test-02 --sort-by='.lastTimestamp'
```

## 🔧 Customization

### Update replicas
Edit `deployment.yaml`:
```yaml
spec:
  replicas: 3  # Change this
```

### Update resources
Edit `deployment.yaml`:
```yaml
resources:
  requests:
    memory: "512Mi"  # Increase
    cpu: "500m"
  limits:
    memory: "1Gi"
    cpu: "1000m"
```

### Update domain
Edit `ingress.yaml`:
```yaml
spec:
  rules:
  - host: your-custom-domain.com  # Change this
```

## 📚 Documentation

- [Repository_B Multi-App Guide](../GIAI-PHAP-REPOSITORY-B.md)
- [ArgoCD Documentation](https://argo-cd.readthedocs.io/)
- [Kubernetes Documentation](https://kubernetes.io/docs/)

---

**Generated**: 2025-10-28 13:42:40  
**Tool**: Django Dev Portal v1.0.0
